(window["webpackJsonpPluginksk-heptacom-admin-open-auth"]=window["webpackJsonpPluginksk-heptacom-admin-open-auth"]||[]).push([[619],{739:function(){},619:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}}),n(133);let{Context:i,Mixin:a,Data:o}=Shopware,{Criteria:d}=o;var s={template:'{% block heptacom_admin_open_auth_client_edit_page %}\n    <sw-page\n        :showSearchBar="false"\n        class="heptacom-admin-open-auth-client-edit-page"\n    >\n        {% block heptacom_admin_open_auth_client_edit_page_inner %}\n        {% endblock %}\n\n        {% block heptacom_admin_open_auth_client_edit_page_smart_bar_header %}\n            <template #smart-bar-header>\n                {{ dynamicName }}\n            </template>\n        {% endblock %}\n\n        {% block heptacom_admin_open_auth_client_edit_page_search_bar_actions %}\n            <template #smart-bar-actions>\n                {% block heptacom_admin_open_auth_client_edit_page_search_bar_actions_help %}\n                    <sw-button\n                        :disabled="isLoading"\n                        :isLoading="isLoading"\n                        :link="item ? $t(\'heptacomAdminOpenAuthClient.providers.\' + item.provider + \'.helpUrl\') : \'\'"\n                    >\n                        <sw-icon name="regular-external-link" small></sw-icon>\n                        {{ $t(\'heptacom-admin-open-auth-client.pages.edit.actions.help\') }}\n                    </sw-button>\n                {% endblock %}\n\n                {% block heptacom_admin_open_auth_client_edit_page_search_bar_actions_delete %}\n                    <sw-button\n                        v-if="acl.can(\'heptacom_admin_open_auth_client.deleter\')"\n                        :disabled="isLoading"\n                        @click="showDeleteModal = true"\n                        variant="danger"\n                    >\n                        {{ $t(\'heptacom-admin-open-auth-client.pages.edit.actions.delete\') }}\n                    </sw-button>\n                {% endblock %}\n\n                {% block heptacom_admin_open_auth_client_edit_page_search_bar_actions_cancel %}\n                    <sw-button\n                        :disabled="isLoading"\n                        @click="cancelEdit"\n                    >\n                        {{ $t(\'heptacom-admin-open-auth-client.pages.edit.actions.cancel\') }}\n                    </sw-button>\n                {% endblock %}\n\n                {% block heptacom_admin_open_auth_client_edit_page_search_bar_actions_save %}\n                    <sw-button-process\n                        :disabled="isLoading"\n                        :isLoading="isLoading"\n                        @click.prevent="saveItem"\n                        v-model="isSaveSuccessful"\n                        variant="primary"\n                    >\n                        {{ $t(\'heptacom-admin-open-auth-client.pages.edit.actions.save\') }}\n                    </sw-button-process>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        {% block heptacom_admin_open_auth_client_edit_page_content %}\n            <template #content>\n                <sw-card-view>\n                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings %}\n                        <sw-card\n                            :isLoading="isLoading"\n                            position-identifier="heptacom-admin-open-auth-client-edit-page-base-settings"\n                        >\n                            <template v-if="item">\n                                {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_name %}\n                                        <sw-text-field\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.name\')"\n                                            v-model="item.name"\n                                        ></sw-text-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_active %}\n                                        <sw-switch-field\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.active\')"\n                                            v-model="item.active"\n                                        ></sw-switch-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_can_login %}\n                                        <sw-switch-field\n                                            :disabled="!item.active"\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.login\')"\n                                            v-model="item.login"\n                                        ></sw-switch-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_can_connect %}\n                                        <sw-switch-field\n                                            :disabled="!item.active"\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.connect\')"\n                                            v-model="item.connect"\n                                        ></sw-switch-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_store_user_token %}\n                                        <sw-switch-field\n                                            :disabled="!item.active"\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.storeUserToken\')"\n                                            v-model="item.storeUserToken"\n                                        ></sw-switch-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_keep_user_updated %}\n                                        <sw-switch-field\n                                            :disabled="!item.active"\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.keepUserUpdated\')"\n                                            :helpText="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.keepUserUpdatedHelpText\')"\n                                            v-model="item.keepUserUpdated"\n                                        ></sw-switch-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_redirect_uri %}\n                                        <sw-text-field\n                                            v-if="redirectUri"\n                                            :copyable="true"\n                                            :copyableTooltip="true"\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.redirectUri\')"\n                                            :value="redirectUri"\n                                            disabled\n                                        ></sw-text-field>\n                                    {% endblock %}\n                                    {% block heptacom_admin_open_auth_client_edit_page_content_base_settings_inner_metadata_uri %}\n                                        <sw-text-field\n                                            v-if="metadataUri"\n                                            :copyable="true"\n                                            :copyableTooltip="true"\n                                            :label="$t(\'heptacom-admin-open-auth-client.pages.edit.fields.metadataUri\')"\n                                            :value="metadataUri"\n                                            disabled\n                                        ></sw-text-field>\n                                        <sw-button\n                                            v-if="metadataUri"\n                                            class="sw-button__metadata-download"\n                                            :disabled="!metadataUri"\n                                            :link="metadataUri"\n                                            size="small"\n                                            :block="true"\n                                        >\n                                            {{ $t(\'heptacom-admin-open-auth-client.pages.edit.fields.downloadMetadata\') }}\n                                        </sw-button>\n                                    {% endblock %}\n                                {% endblock %}\n                            </template>\n                        </sw-card>\n                    {% endblock %}\n\n                    {% block heptacom_admin_open_auth_client_edit_page_content_role_assignment %}\n                        <sw-card\n                            :isLoading="isLoading"\n                            :title="$t(\'heptacom-admin-open-auth-client.pages.edit.roleAssignment.title\')"\n                            position-identifier="heptacom-admin-open-auth-client-edit-page-role-assignment"\n                        >\n                            <template v-if="item">\n                                {% block heptacom_admin_open_auth_client_edit_page_content_role_assignment_inner %}\n                                    <heptacom-admin-open-auth-client-rule-container\n                                        :client="item"\n                                        @rule-deleted="onRuleDeleted"\n                                        @conditions-deleted="onConditionsDeleted"\n                                    ></heptacom-admin-open-auth-client-rule-container>\n                                {% endblock %}\n                            </template>\n                        </sw-card>\n                    {% endblock %}\n\n                    {% block heptacom_admin_open_auth_client_edit_page_content_provider_settings %}\n                        <component\n                            v-if="item && item.provider"\n                            :is="providerSettingsComponent"\n                            v-bind="providerSettingsProps"\n                        ></component>\n                    {% endblock %}\n                </sw-card-view>\n\n                {% block heptacom_admin_open_auth_client_edit_page_content_modal_delete %}\n                    <sw-modal\n                        v-if="showDeleteModal"\n                        :title="$t(\'heptacom-admin-open-auth-client.pages.edit.modals.delete.title\')"\n                        @modal-close="showDeleteModal = false"\n                        variant="small"\n                    >\n                        {% block heptacom_admin_open_auth_client_edit_page_content_modal_delete_confirm_text %}\n                            <p>\n                                {{ $t(\'heptacom-admin-open-auth-client.pages.edit.modals.delete.warning\') }}\n                            </p>\n                            <p>\n                                <strong>{{ dynamicName }}</strong>\n                            </p>\n                            <p>\n                                {{ $t(\'heptacom-admin-open-auth-client.pages.edit.modals.delete.explanation\') }}\n                            </p>\n                        {% endblock %}\n\n                        {% block heptacom_admin_open_auth_client_edit_page_content_modal_delete_footer %}\n                            <template #modal-footer>\n                                {% block heptacom_admin_open_auth_client_edit_page_content_modal_delete_abort %}\n                                    <sw-button\n                                        size="small"\n                                        @click="showDeleteModal = false"\n                                    >\n                                        {{ $t(\'heptacom-admin-open-auth-client.pages.edit.modals.delete.cancel\') }}\n                                    </sw-button>\n                                {% endblock %}\n\n                                {% block heptacom_admin_open_auth_client_edit_page_content_modal_delete_delete %}\n                                    <sw-button\n                                        size="small"\n                                        variant="danger"\n                                        @click="onConfirmDelete"\n                                    >\n                                        {{ $t(\'heptacom-admin-open-auth-client.pages.edit.modals.delete.confirm\') }}\n                                    </sw-button>\n                                {% endblock %}\n                            </template>\n                        {% endblock %}\n                    </sw-modal>\n                {% endblock %}\n            </template>\n        {% endblock %}\n    </sw-page>\n{% endblock %}\n',inject:["acl","repositoryFactory","HeptacomAdminOpenAuthProviderApiService"],mixins:[a.getByName("placeholder"),a.getByName("notification")],props:{clientId:{required:!0,type:String}},data(){return{isLoading:!0,isSaveSuccessful:!1,item:null,showDeleteModal:!1,redirectUri:null,metadataUri:null,deletedRuleIds:[],deletedConditionIds:[]}},created(){this.loadData()},computed:{dynamicName(){return this.placeholder(this.item,"name",this.$t("heptacom-admin-open-auth-client.pages.edit.title"))},clientRepository(){return this.repositoryFactory.create("heptacom_admin_open_auth_client")},ruleRepository(){return this.repositoryFactory.create("heptacom_admin_open_auth_client_rule")},ruleConditionRepository(){return this.repositoryFactory.create("heptacom_admin_open_auth_client_rule_condition")},clientCriteria(){let e=new d;return e.getAssociation("rules").addSorting(d.sort("position","ASC")),e.addAssociation("rules.aclRoles"),e.addAssociation("rules.conditions"),e.addAssociation("defaultAclRoles"),e},providerSlug(){return(this.item&&this.item.provider?this.item.provider:"").replace(/_/g,"-")},providerSettingsComponent(){return`heptacom-admin-open-auth-provider-${this.providerSlug}-settings`},providerSettingsProps(){return{item:this.item}}},methods:{loadData(){this.isLoading=!0,this.loadClient().finally(()=>{this.isLoading=!1})},async loadClient(){this.item=null,this.item=await this.clientRepository.get(this.clientId,i.api,this.clientCriteria),this.redirectUri=(await this.HeptacomAdminOpenAuthProviderApiService.getRedirectUri(this.item.id)).target,this.metadataUri=(await this.HeptacomAdminOpenAuthProviderApiService.getMetadataUri(this.item.id)).target},cancelEdit(){this.$router.push({name:this.$route.meta.parentPath})},saveItem(){this.isLoading=!0,this.saveClient().then(this.syncDeletedConditions).then(this.syncDeletedRules).then(()=>(this.isSaveSuccessful=!0,this.loadData())).catch(e=>{let t=this.client.name;throw this.createNotificationError({title:this.$tc("global.notification.notificationSaveErrorTitle"),message:this.$tc("global.notification.notificationSaveErrorMessage",0,{entityName:t})}),e}).finally(()=>{this.isLoading=!1})},saveClient(){return this.clientRepository.save(this.item,i.api)},syncDeletedRules(){if(this.deletedRuleIds.length>0)return this.ruleRepository.syncDeleted(this.deletedRuleIds,i.api).then(()=>{this.deletedRuleIds=[]})},syncDeletedConditions(){if(this.deletedConditionIds.length>0)return this.ruleConditionRepository.syncDeleted(this.deletedConditionIds,i.api).then(()=>{this.deletedConditionIds=[]})},onRuleDeleted(e){this.deletedRuleIds.push(e)},onConditionsDeleted(e){this.deletedConditionIds=[...this.deletedConditionIds,...e]},onConfirmDelete(){return this.showDeleteModal=!1,this.isLoading=!0,this.clientRepository.delete(this.item.id,i.api).then(()=>{this.$router.push({name:"heptacom.admin.open.auth.client.settings"})}).catch(e=>{let t=this.client.name;throw this.createNotificationError({title:this.$tc("global.notification.notificationSaveErrorTitle"),message:this.$tc("global.notification.notificationSaveErrorMessage",0,{entityName:t})}),e}).finally(()=>{this.isLoading=!1})}}}},133:function(e,t,n){var i=n(739);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals),n(346).Z("82683d1c",i,!0,{})},346:function(e,t,n){"use strict";function i(e,t){for(var n=[],i={},a=0;a<t.length;a++){var o=t[a],d=o[0],s={id:e+":"+a,css:o[1],media:o[2],sourceMap:o[3]};i[d]?i[d].parts.push(s):n.push(i[d]={id:d,parts:[s]})}return n}n.d(t,{Z:function(){return h}});var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},d=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,c=!1,r=function(){},p=null,_="data-vue-ssr-id",m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(e,t,n,a){c=n,p=a||{};var d=i(e,t);return u(d),function(t){for(var n=[],a=0;a<d.length;a++){var s=o[d[a].id];s.refs--,n.push(s)}t?u(d=i(e,t)):d=[];for(var a=0;a<n.length;a++){var s=n[a];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete o[s.id]}}}}function u(e){for(var t=0;t<e.length;t++){var n=e[t],i=o[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(b(n.parts[a]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{for(var d=[],a=0;a<n.parts.length;a++)d.push(b(n.parts[a]));o[n.id]={id:n.id,refs:1,parts:d}}}}function g(){var e=document.createElement("style");return e.type="text/css",d.appendChild(e),e}function b(e){var t,n,i=document.querySelector("style["+_+'~="'+e.id+'"]');if(i){if(c)return r;i.parentNode.removeChild(i)}if(m){var a=l++;t=v.bind(null,i=s||(s=g()),a,!1),n=v.bind(null,i,a,!0)}else t=w.bind(null,i=g()),n=function(){i.parentNode.removeChild(i)};return t(e),function(i){i?(i.css!==e.css||i.media!==e.media||i.sourceMap!==e.sourceMap)&&t(e=i):n()}}var f=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function v(e,t,n,i){var a=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=f(t,a);else{var o=document.createTextNode(a),d=e.childNodes;d[t]&&e.removeChild(d[t]),d.length?e.insertBefore(o,d[t]):e.appendChild(o)}}function w(e,t){var n=t.css,i=t.media,a=t.sourceMap;if(i&&e.setAttribute("media",i),p.ssrId&&e.setAttribute(_,t.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}}]);
//# sourceMappingURL=13155452423993f4909c.js.map