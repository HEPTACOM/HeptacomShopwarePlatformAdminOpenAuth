const l=`{% block heptacom_admin_open_auth_client_rule_container %} <div> <mt-loader v-if="isLoading"></mt-loader> <template v-else> <template v-for="rule in sortedRules" :key="rule.id" > <heptacom-admin-open-auth-client-rule-item :rule="rule" :client="client" :action="action" @conditions-deleted="conditionsDeleted" @move-up="moveRuleUp(rule)" @move-down="moveRuleDown(rule)" @delete="deleteRule(rule)" ></heptacom-admin-open-auth-client-rule-item> </template> <mt-banner v-if="sortedRules.length === 0" variant="attention" > {{ $t('heptacom-admin-open-auth-client.components.rule-container.warningEmpty') }} </mt-banner> <mt-button block @click="addRule" variant="secondary" > {{ $t('global.default.add') }} </mt-button> </template> </div> {% endblock %}`,a={template:l,inject:["repositoryFactory","ruleConditionsConfigApiService"],props:{client:{required:!0,type:Object},action:{required:!0,type:Array}},data(){return{isLoading:!1}},computed:{ruleRepository(){return this.repositoryFactory.create("heptacom_admin_open_auth_client_rule")},sortedRules(){return this.client.rules.filter(e=>e.actionName===this.action.name).sort((e,t)=>e.position-t.position)}},created(){this.createdComponent().then()},methods:{async createdComponent(){this.isLoading=!0,await this.loadConditionData(),this.isLoading=!1},async loadConditionData(){await this.ruleConditionsConfigApiService.load()},addRule(){const e=this.ruleRepository.create();e.clientId=this.client.id,e.actionName=this.action.name,e.actionConfig={},e.position=this.sortedRules.length,this.client.rules.add(e)},conditionsDeleted(e){this.$emit("conditions-deleted",e)},moveRuleUp(e){this.swapRules(e.position,e.position-1)},moveRuleDown(e){this.swapRules(e.position,e.position+1)},deleteRule(e){this.$emit("rule-deleted",e.id),this.client.rules.remove(e.id);let t=0;for(const i of this.sortedRules)i.position=t,t++},swapRules(e,t){let i=null,o=null;for(const n of this.sortedRules){if(i===null&&n.position===e){i=n;continue}if(o===null&&n.position===t){o=n;continue}}i===null||o===null||(i.position=t,o.position=e)}}};export{a as default};
//# sourceMappingURL=index-Dp6dsyza.js.map
